# bubi_prediction

The 'bubi_prediction' project was generated by using the default-python template.

## Target environment

Serverless environment version 3 <https://docs.databricks.com/aws/en/release-notes/serverless/environment-version/three>

## Notes

The current logic is for a classical model, not for time series prediction. In this case, we should probably register a new model every day, and use that, no matter what. The fact that we registered a baseline model a long time ago should not mean that we don't overwrite that for example, because since then, we have a lot more data to train on.

I think this setup should be rewritten to use XGBoost for prediction with some features

## TODO

To make predictions with the prophet model, we must use the make_future_dataframe of the trained Prophet model. For this, we need to load it with mlflow.prophet.load_model. To retain the possibility for replacement with another type of model later, it would be nice to load it as a pyfunc, but then there is no make_future_dataframe. The solution is to wrap the model in a PythonModel. Then we can also post process it to return a non-negative integer.

We cannot load it as a Spark UDF as far as I know. So then we should make the predictions as a Pandas dataframe, create a Spark DF out of it, then merge it into a table that contains the predictions so far. We should also store the model version and the date of prediction in that so far, so it could be SCD type 2.

"module prophet not found" -- the issue was that mlflow versions were mismatched and prophet was missing in the notebook.
